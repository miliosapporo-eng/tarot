<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Tarot â€” 3D Shuffle / Mobile / Layouts</title>
<style>
:root{
  --bg1:#07111a; --bg2:#0b1620; --panel:#0f2430; --accent:#f6b042; --muted:#9fb0c1;
  --card-w:200px; --card-h:300px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;padding:18px;font-family:system-ui,-apple-system,"Noto Sans JP",sans-serif;
  background: linear-gradient(180deg,var(--bg1),var(--bg2)); color:#e8f1f8;
  -webkit-font-smoothing:antialiased;
}
.header{display:flex;align-items:center;gap:12px;flex-wrap:wrap;margin-bottom:14px}
h1{margin:0;font-size:18px}
.controls{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.controls button, .controls select, .controls input[type=number]{
  padding:8px 10px;border-radius:10px;border:0;background:#09222f;color:#e8f1f8;font-weight:600;cursor:pointer;
}
.btn-primary{background:linear-gradient(180deg,var(--accent),#e89b27);color:#08101a}
.small{font-size:13px;color:var(--muted)}
.main{display:flex;gap:18px;align-items:flex-start;flex-wrap:wrap}
.left{width:260px;min-width:240px}
.shuffle-stage{
  width:var(--card-w); height:var(--card-h); border-radius:12px; position:relative;
  background:linear-gradient(180deg,#06151c,#071824); overflow:hidden; box-shadow:0 12px 40px rgba(2,6,23,0.7);
  display:flex;align-items:center;justify-content:center; perspective:1200px;
}
.stack{
  width:180px;height:260px; position:relative; transform-style:preserve-3d;
}
.stack .card{
  position:absolute; left:0; top:0; width:180px;height:260px;border-radius:10px; overflow:hidden;
  background:#fff; display:flex;align-items:center;justify-content:center; backface-visibility:hidden;
  box-shadow: 0 12px 30px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.06);
  transform-origin:center;
}
.stack .card img{width:100%;height:100%;object-fit:cover; pointer-events:none; user-select:none}
.hud{margin-top:8px;font-size:13px;color:var(--muted)}
.right{flex:1;min-width:300px}
.layout-controls{display:flex;gap:8px;align-items:center;margin-bottom:8px}
.slots-area{
  position:relative; min-height:420px; border-radius:12px; padding:12px;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border:1px solid rgba(255,255,255,0.03);
  box-shadow: 0 8px 30px rgba(0,0,0,0.5);
}
.slot{
  position:absolute; width:120px;height:170px;border-radius:8px;background:linear-gradient(180deg,#07111a,#071623);
  display:flex;align-items:center;justify-content:center; overflow:hidden; transform-style:preserve-3d;
  transition:transform .6s cubic-bezier(.2,.9,.2,1), opacity .3s;
  border:1px solid rgba(255,255,255,0.03);
}
.slot .inner{width:110px;height:160px;border-radius:6px;overflow:hidden;background:#071421;display:flex;align-items:center;justify-content:center}
.slot img{width:100%;height:100%;object-fit:cover; transform-origin:center; transition:transform .45s}
.slot .index{position:absolute;left:6px;top:6px;background:rgba(0,0,0,0.6);padding:4px 6px;border-radius:6px;font-size:12px}
.controls-row{display:flex;gap:8px;align-items:center;margin-top:10px;flex-wrap:wrap}

/* responsive: small screens */
@media (max-width:760px){
  .main{flex-direction:column}
  .left{width:100%}
  .shuffle-stage{margin:0 auto}
  .slots-area{min-height:360px}
  .slot{width:90px;height:130px}
  .slot .inner{width:80px;height:120px}
  :root{--card-w:160px;--card-h:240px}
}

/* 3D animations helpers */
@keyframes stackExplode {
  0% { transform: translateZ(0) rotateY(0) translateX(0) translateY(0); opacity:1 }
  60% { transform: translateZ(40px) rotateY(30deg) translateX(-6px) translateY(-6px); opacity:1 }
  100% { transform: translateZ(0) rotateY(0) translateX(0) translateY(0); opacity:1 }
}
.card-fly {
  transition: transform 0.9s cubic-bezier(.2,.9,.2,1), opacity .4s;
  will-change: transform;
}

/* small UI niceties */
.badge{background:rgba(255,255,255,0.03);padding:6px 8px;border-radius:8px;font-size:13px
